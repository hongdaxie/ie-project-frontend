{"version":3,"sources":["views/Account/AddNew.js"],"names":["Option","MonthPicker","AddNew","handleSubmit","e","preventDefault","props","form","validateFieldsAndScroll","err","values","currentYear","Date","getFullYear","year","moment","format","date","console","log","user","id","match","params","userid","parentInfo","JSON","stringify","setState","isLoading","addNewGrandparent","then","resp","data","success","history","push","pathname","error","finally","validateToPhoneNumber","rule","value","callback","test","validateName","validateLength","length","state","getFieldDecorator","this","prefixSelector","initialValue","style","width","lg","span","offset","md","marginTop","marginBottom","maxWidth","margin","textAlign","fontWeight","fontSize","labelCol","xs","sm","wrapperCol","onSubmit","Item","label","rules","type","message","required","disabled","whitespace","validator","title","addonBefore","placeholder","htmlType","loading","Component","create","name","withRouter"],"mappings":"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","file":"static/js/15.3578ea5f.chunk.js","sourcesContent":["import React, { Component } from 'react'\nimport { Form, Input, Tooltip, Icon, Col, Button, Card, message, DatePicker, Select } from 'antd'\nimport { addNewGrandparent } from '../../requests'\nimport { withRouter } from 'react-router-dom'\nimport * as moment from 'moment'\n\n\nconst { Option } = Select;\nconst { MonthPicker } = DatePicker\nclass AddNew extends Component {\n    constructor(){\n        super()\n        this.state= {\n            isLoading: false\n        }\n    }\n\n    handleSubmit = e => {\n        e.preventDefault();\n        this.props.form.validateFieldsAndScroll((err, values) => {\n          if (!err) {\n            // console.log(values[\"lastVaccineDate\"].year())\n            const currentYear = new Date().getFullYear()\n            if(values[\"lastVaccineDate\"].year() < currentYear){\n                values[\"nextVaccineDate\"] = moment().format('YYYY-MM-DD')\n            }else{\n                values[\"nextVaccineDate\"] = `${currentYear+1}-04-01`\n            }\n            // console.log(values[\"nextVaccineDate\"])\n            const date = values['lastVaccineDate'].format(\"YYYY-MM-01\")\n            values[\"lastVaccineDate\"] = date\n            console.log('Received values of form: ', values)\n            // values.receiveNotification = values.receiveNotification? values.receiveNotification : false\n            const user =  {id: this.props.match.params.id}\n            values.userid = user\n            const parentInfo =  JSON.stringify(values)\n            this.setState({\n                isLoading: true\n            })\n            addNewGrandparent(parentInfo)\n                .then(resp=>{\n                    // console.log(resp)\n                    if(resp.data){\n                        message.success(\"You have added successfully!\")\n                        this.props.history.push({\n                            pathname: `/account`,\n                        })\n                    }else{\n                        message.error(\"Failed to add!\")\n                    }\n                })\n                .finally(()=>{\n                    this.setState({\n                        isLoading: false\n                    })\n                })\n            }\n        });\n    };\n    \n    validateToPhoneNumber = (rule, value, callback) => {\n        const phonePattern = /^04\\d{8}$/\n        // console.log(\"111\")\n        if(!phonePattern.test(value)){\n            // console.log(\"222\")\n            callback('You should input legal phone number! Such as: 0413174686 ');\n        }else{\n            // console.log(\"333\")\n            callback()\n        }\n    }\n\n    validateName = (rule, value, callback) => {\n        const namePattern = /^[A-Za-z\\s]+$/\n        // console.log(\"111\")\n        if(!namePattern.test(value)){\n          callback('You should input legal name!');\n        }else{\n          callback()\n        }\n      }\n    \n    validateLength = (rule, value, callback) => {\n        if(value.length> 20){\n            callback(\"The length of the name should no more than 20.\")\n        }else{\n            callback()\n        }\n    }\n\n    render() {\n        // console.log(moment().format('YYYY-MM-DD'))\n        // console.log(this.props.match.params.id)\n        const { getFieldDecorator } = this.props.form;\n        const prefixSelector = getFieldDecorator('prefix', {\n            initialValue: '61',\n          })(\n            <Select style={{ width: 70 }}>\n              <Option value=\"61\">+61</Option>\n            </Select>,\n          )\n        \n        const formItemLayout = {\n            labelCol: {\n                xs: { span: 24 },\n                sm: { span: 8 },\n            },\n            wrapperCol: {\n                xs: { span: 24 },\n                sm: { span: 16 },\n            },\n            };\n        const tailFormItemLayout = {\n        wrapperCol: {\n            xs: {\n            span: 24,\n            offset: 0,\n            },\n            sm: {\n            span: 16,\n            offset: 8,\n            },\n            },\n        };\n\n        const config = {\n            rules: [{ type: 'object', required: true, message: 'Please select time!' }],\n        };\n\n        return (\n            <div>\n                <Col lg={{span:12, offset:6}} md = {{span: 22, offset:1}} style={{marginTop:\"24px\", marginBottom:\"24px\"}}>\n                <Card \n                    style={{maxWidth: \"500px\", margin: \"auto\"}}\n                >\n                    <div style={{textAlign:\"center\", fontWeight:\"bold\", fontSize: \"24px\", marginBottom:\"20px\"}}>Add new</div>\n                <Form {...formItemLayout} onSubmit={this.handleSubmit} >\n                    <Form.Item label=\"E-mail\" >\n                    {getFieldDecorator('email', {\n                        rules: [\n                        {\n                            type: 'email',\n                            message: 'The input is not valid E-mail!',\n                        },\n                        {\n                            required: true,\n                            message: 'Please input your E-mail!',\n                        },\n                        ],\n                    })(<Input disabled = {this.state.isLoading} />)}\n                    </Form.Item>\n                    <Form.Item\n                    label='name'\n                    >\n                    {getFieldDecorator('name', {\n                        rules: [\n                            { required: true, message: 'Please input name!', whitespace: true },\n                            { validator: this.validateName},\n                            { validator: this.validateLength}\n                        ],\n                    })(<Input disabled = {this.state.isLoading}/>)}\n                    </Form.Item>\n                    <Form.Item\n                    label={\n                        <span>\n                        Relationship&nbsp;\n                        <Tooltip title=\"What`s the relationship with he/she?\">\n                            <Icon type=\"question-circle-o\" />\n                        </Tooltip>\n                        </span>\n                    }\n                    >\n                    {getFieldDecorator('relationship', {\n                        rules: [\n                            {required: true, message: 'Please input relationship!', whitespace: true },\n                            { validator: this.validateLength},\n                            { validator: this.validateName},\n                    ],\n                    })(<Input disabled = {this.state.isLoading}/>)}\n                    </Form.Item>\n                    <Form.Item \n                        label={\n                            <span>\n                            Vaccine record&nbsp;\n                            <Tooltip title=\"When was the last tiem that the person took the flu shot?\">\n                            <Icon type=\"question-circle-o\" />\n                            </Tooltip>\n                            </span>\n                        }\n                    >\n                        {getFieldDecorator('lastVaccineDate', config)(<MonthPicker />)}\n                    </Form.Item>\n                    <Form.Item label=\"Phone Number\">\n                        {getFieldDecorator('phoneNumber', {\n                        rules: [{ required: true, message: 'Please input your phone number!' }, { validator: this.validateToPhoneNumber }],\n                        })(<Input addonBefore={prefixSelector} placeholder=\"e.g.0431374686\" style={{ width: '100%' }} />)}\n                    </Form.Item>\n                    <Form.Item {...tailFormItemLayout}>\n                    <Button type=\"primary\" htmlType=\"submit\" loading={this.state.isLoading}>\n                        Add\n                    </Button>\n                    </Form.Item>\n                </Form>\n                </Card>\n            </Col>\n            </div>\n        )\n    }\n}\n\nexport default Form.create({ name: 'newGrandparent' })(withRouter(AddNew))"],"sourceRoot":""}